<!DOCTYPE html>
<html>
<head>

<!-- Responsive -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<!-- Title -->
<title>PWA Tutorial</title>

<!-- Meta Tags required for Progressive Web App -->
<meta name="apple-mobile-web-app-status-bar" content="#aa7700">
<meta name="theme-color" content="black">

<!-- Manifest File link -->
<link rel="manifest" href="manifest.json">

<style>
    /* Ensure the image resizes dynamically */
    #apod {
        max-width: 100%; /* Ensures image fits the screen */
        height: auto; /* Maintains aspect ratio */
        display: block; /* Removes extra spacing */
        margin: 0 auto; /* Centers the image */
    }
</style>

</head>

<body>
    <img id="apod" alt="APOD Image">
    <p id="explanation"></p> <!-- Added an ID to the <p> tag -->

    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("sw.js")
                .then((reg) => console.log("Service Worker Registered ✅", reg))
                .catch((err) => console.error("Service Worker Error ❌", err));
        }

        async function get_apod() {
            let api_url = "https://api.nasa.gov/planetary/apod?api_key=PV0qEJBHTvngHQBb4VNJQgCXxdyrlaCe5m42FQlJ";
            try {
                const response = await fetch(api_url);
                const json = await response.json();
                let image_url = json["hdurl"] || json["url"];
                let explanation_text = json["explanation"];

                let img = document.getElementById("apod");
                let explanation = document.getElementById("explanation");

                img.src = image_url;
                explanation.textContent = explanation_text; // Set text content of <p>

            } catch (error) {
                console.error("Error fetching APOD image:", error);
            }
        }

        window.onload = get_apod;
    </script>
</body>

</html>
